  \NeedsTeXFormat{LaTeX2e}

  \ProcessOptions\relax
\newcommand{\mc}{\mathcal}
\usepackage{xcolor}

% ToC không có link/màu
\usepackage{etoolbox}
\pretocmd{\tableofcontents}{\hypersetup{hidelinks}}{}{}
\apptocmd{\tableofcontents}{\hypersetup{colorlinks=true,linkcolor=magenta}}{}{}
\usepackage{graphicx}
\usepackage{pdfpages} % nếu bìa là PDF 1 trang
\usepackage{tikz}
\usetikzlibrary{calc,arrows.meta}
\usepackage{tikz-cd}
\newcommand{\supp}{\mathrm{supp}}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\ti}{\tilde}
\newcommand{\vol}{\mathrm{Vol}}
\newcommand{\atlas}{\mathcal{A}}
\newcommand{\btlas}{\mathcal{B}}
\newcommand{\ctlas}{\mathcal{C}}
\newcommand{\clo}{\overline}
\newcommand{\vect}{\overrightarrow}
\newcommand{\multi}{\mathrm{Multi}}
\newcommand{\pa}{\partial}
\newcommand{\de}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ome}{\omega}
\newcommand{\bb}{\mathbb}
\newcommand{\ep}{\varepsilon}
\newcommand{\limit}{\displaystyle \lim}
\newcommand{\ra}{\Rightarrow}
\newcommand{\lra}{\Leftrightarrow}
\newcommand{\dsum}{\displaystyle \sum}
\newcommand{\dprof}{\displaystyle \prod}
\newcommand{\nlim}{\displaystyle \lim_{n \to +\infty}}
\newcommand{\series}{\dsum_{n = 1}^{\infty}}
\newcommand{\diam}{\mathrm{diam}}
% Common linear algebra operators
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\kernel}{\mathrm{ker}}
\newcommand{\im}{\mathrm{Im}}
\newcommand{\spann}{\mathrm{span}}
\newcommand{\cl}{\mathrm{cl}}
\newcommand{\inte}{\mathrm{Int}}
\newcommand{\exte}{\mathrm{Ext}}
\newcommand{\alt}{\mathrm{Alt}}
\newcommand{\sng}{\mathrm{sgn}}
\newcommand{\sgn}{\mathrm{sgn}}
%Some useful spaces
\newcommand{\circl}{\bb{S}}
\newcommand{\real}{\bb{R}}
\newcommand{\comple}{\bb{complex}}

\usepackage{amsmath,amssymb}
\usepackage{mdframed}

\usepackage{fontspec}





% Bỏ inputenc và fontenc vì XeLaTeX không cần
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage[nameinlink,noabbrev]{cleveref}

\crefformat{equation}{(#2#1#3)}
\Crefformat{equation}{(#2#1#3)}



\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{amsthm}
\renewcommand{\bibname}{\large\bfseries References}



\newenvironment{sol}{%
  \begin{proof}[Solution]%
}{%
  \end{proof}%
}
  % fonts

  \newtheorem{mythm}{dummy}[subsection]
  % --- Theorem-style things ---
  \newtheoremstyle{sfstyle}% name
    {\topsep}   % space above
    {\topsep}   % space below
    {\normalfont}  % body font
    {}          % indent
    {\bfseries}    % theorem head font
    {.}         % punctuation after theorem head
    {0.5em}     % space after theorem head
    {\thmname{#1}~\thmnumber{#2}\thmnote{\normalfont\ (#3)}}

  \theoremstyle{sfstyle}
  
  \newtheorem{problem}{Problem}[chapter]

% Định nghĩa lại cách đánh số

% Sections are numbered within each chapter: 1,2,3,... (reset every chapter)
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}

% If you also want subsection/subsubsection to NOT show numbers at all:
% \setcounter{secnumdepth}{1}

% Problem resets each chapter and shows Chapter.Problem
\renewcommand{\themythm}{\thechapter.\arabic{mythm}}
\renewcommand{\theproblem}{\thechapter.\arabic{problem}}


  \newtheorem{definition}[mythm]{Definition}
  \newtheorem{lemma}[mythm]{Lemma}
  \newtheorem{example}[mythm]{Example}
  \newtheorem{corollary}[mythm]{Corollary}
  \newtheorem{claim}[mythm]{Claim}
  \newtheorem{remark}[mythm]{Remark}
  \newtheorem{proposition}[mythm]{Proposition}
  \newmdtheoremenv{boxedlemma}{Lemma}
  \newtheorem{theorem}[mythm]{Theorem}
  \usepackage{array}
  \usepackage{booktabs}

  % set page geometry
  \usepackage[verbose=true,letterpaper]{geometry}
  \AtBeginDocument{
    \newgeometry{
      textheight=9in,
      textwidth=6.5in,
      top=1in,
      headheight=14pt,
      headsep=25pt,
      footskip=30pt
    }
  }

  \widowpenalty=10000
  \clubpenalty=10000
  \flushbottom
  \sloppy

  \usepackage{fancyhdr}
  \fancyhf{}
  \pagestyle{fancy}
  \renewcommand{\headrulewidth}{0pt}
  \fancyheadoffset{0pt}
  \rhead{\scshape \today}
  \lhead{\scshape Aleksis J. Arendt}
  \cfoot{\thepage}


  %Handling Keywords
  \def\keywordname{{\bfseries \emph Keywords}}%
  \def\keywords#1{\par\addvspace\medskipamount{\rightskip=0pt plus1cm
  \def\and{\ifhmode\unskip\nobreak\fi\ $\cdot$
  }\noindent\keywordname\enspace\ignorespaces#1\par}}

  % font sizes with reduced leading

  % sections with less space
  \providecommand{\section}{}
  \renewcommand{\section}{%
    \@startsection{section}{1}{\z@}%
                  {-2.0ex \@plus -0.5ex \@minus -0.2ex}%
                  { 1.5ex \@plus  0.3ex \@minus  0.2ex}%
                  {\large\bf\raggedright}%
  }


  \providecommand{\subsection}{}
  \renewcommand{\subsection}{%
    \@startsection{subsection}{2}{\z@}%
                  {-1.8ex \@plus -0.5ex \@minus -0.2ex}%
                  { 0.8ex \@plus  0.2ex}%
                  {\normalsize\bf\raggedright}%
  }
  \providecommand{\subsubsection}{}
  \renewcommand{\subsubsection}{%
    \@startsection{subsubsection}{3}{\z@}%
                  {-1.5ex \@plus -0.5ex \@minus -0.2ex}%
                  { 0.5ex \@plus  0.2ex}%
                  {\normalsize\bf\raggedright}%
  }
  \providecommand{\paragraph}{}
  \renewcommand{\paragraph}{%
    \@startsection{paragraph}{4}{\z@}%
                  {1.5ex \@plus 0.5ex \@minus 0.2ex}%
                  {-1em}%
                  {\normalsize\bf}%
  }
  \providecommand{\subparagraph}{}
  \renewcommand{\subparagraph}{%
    \@startsection{subparagraph}{5}{\z@}%
                  {1.5ex \@plus 0.5ex \@minus 0.2ex}%
                  {-1em}%
                  {\normalsize\bf}%
  }
  \providecommand{\subsubsubsection}{}
  \renewcommand{\subsubsubsection}{%
    \vskip5pt{\noindent\normalsize\rm\raggedright}%
  }

  % float placement
  \renewcommand{\topfraction      }{0.85}
  \renewcommand{\bottomfraction   }{0.4}
  \renewcommand{\textfraction     }{0.1}
  \renewcommand{\floatpagefraction}{0.7}

  \newlength{\@abovecaptionskip}\setlength{\@abovecaptionskip}{7\p@}
  \newlength{\@belowcaptionskip}\setlength{\@belowcaptionskip}{\z@}

  \setlength{\abovecaptionskip}{\@abovecaptionskip}
  \setlength{\belowcaptionskip}{\@belowcaptionskip}

  % swap above/belowcaptionskip lengths for tables
  \renewenvironment{table}
    {\setlength{\abovecaptionskip}{\@belowcaptionskip}%
    \setlength{\belowcaptionskip}{\@abovecaptionskip}%
    \@float{table}}
    {\end@float}

  % footnote formatting
  \setlength{\footnotesep }{6.65\p@}
  \setlength{\skip\footins}{9\p@ \@plus 4\p@ \@minus 2\p@}
  \renewcommand{\footnoterule}{\kern-3\p@ \hrule width 12pc \kern 2.6\p@}
  \setcounter{footnote}{0}

  % paragraph formatting
  \setlength{\parindent}{\z@}
  \setlength{\parskip  }{5.5\p@}

  % list formatting
  \setlength{\topsep       }{4\p@ \@plus 1\p@   \@minus 2\p@}
  \setlength{\partopsep    }{1\p@ \@plus 0.5\p@ \@minus 0.5\p@}
  \setlength{\itemsep      }{2\p@ \@plus 1\p@   \@minus 0.5\p@}
  \setlength{\parsep       }{2\p@ \@plus 1\p@   \@minus 0.5\p@}
  \setlength{\leftmargin   }{3pc}
  \setlength{\leftmargini  }{\leftmargin}
  \setlength{\leftmarginii }{2em}
  \setlength{\leftmarginiii}{1.5em}
  \setlength{\leftmarginiv }{1.0em}
  \setlength{\leftmarginv  }{0.5em}
  \def\@listi  {\leftmargin\leftmargini}
  \def\@listii {\leftmargin\leftmarginii
                \labelwidth\leftmarginii
                \advance\labelwidth-\labelsep
                \topsep  2\p@ \@plus 1\p@    \@minus 0.5\p@
                \parsep  1\p@ \@plus 0.5\p@ \@minus 0.5\p@
                \itemsep \parsep}
  \def\@listiii{\leftmargin\leftmarginiii
                \labelwidth\leftmarginiii
                \advance\labelwidth-\labelsep
                \topsep    1\p@ \@plus 0.5\p@ \@minus 0.5\p@
                \parsep    \z@
                \partopsep 0.5\p@ \@plus 0\p@ \@minus 0.5\p@
                \itemsep \topsep}
  \def\@listiv {\leftmargin\leftmarginiv
                \labelwidth\leftmarginiv
                \advance\labelwidth-\labelsep}
  \def\@listv  {\leftmargin\leftmarginv
                \labelwidth\leftmarginv
                \advance\labelwidth-\labelsep}
  \def\@listvi {\leftmargin\leftmarginvi
                \labelwidth\leftmarginvi
                \advance\labelwidth-\labelsep}

  % create title
  \providecommand{\maketitle}{}
  \renewcommand{\maketitle}{%
    \par
    \begingroup
      \renewcommand{\thefootnote}{\fnsymbol{footnote}}
      % for perfect author name centering
      \renewcommand{\@makefnmark}{\hbox to \z@{$^{\@thefnmark}$\hss}}
      % The footnote-mark was overlapping the footnote-text,
      % added the following to fix this problem               (MK)
      \long\def\@makefntext##1{%
        \parindent 1em\noindent
        \hbox to 1.8em{\hss $\m@th ^{\@thefnmark}$}##1
      }
      \thispagestyle{empty}
      \@maketitle
      \@thanks
      %\@notice
    \endgroup
    \let\maketitle\relax
    \let\thanks\relax
  }

  % rules for title box at top of first page
  \newcommand{\@toptitlebar}{
    \hrule height 2\p@
    \vskip 0.25in
    \vskip -\parskip%
  }
  \newcommand{\@bottomtitlebar}{
    \vskip 0.29in
    \vskip -\parskip
    \hrule height 2\p@
    \vskip 0.09in%
  }

  % create title (includes both anonymized and non-anonymized versions)
  \providecommand{\@maketitle}{}
  \renewcommand{\@maketitle}{%
    \vbox{%
      \hsize\textwidth
      \linewidth\hsize
      \vskip 0.1in
      \@toptitlebar
      \centering
      {\LARGE\sc \@title\par}
      \@bottomtitlebar
      \textsc{}\\
      \vskip 0.1in
      \def\And{%
        \end{tabular}\hfil\linebreak[0]\hfil%
        \begin{tabular}[t]{c}\bf\rule{\z@}{24\p@}\ignorespaces%
      }
      \def\AND{%
        \end{tabular}\hfil\linebreak[4]\hfil%
        \begin{tabular}[t]{c}\bf\rule{\z@}{24\p@}\ignorespaces%
      }
      \begin{tabular}[t]{c}\bf\rule{\z@}{24\p@}\@author\end{tabular}%
    \vskip 0.4in \@minus 0.1in \center{\today}   \vskip 0.2in
    }
  }

  % add conference notice to bottom of first page
  \newcommand{\ftype@noticebox}{8}
  \newcommand{\@notice}{%
    % give a bit of extra room back to authors on first page
    \enlargethispage{2\baselineskip}%
    \@float{noticebox}[b]%
      \footnotesize\@noticestring%
    \end@float%
  }

  % abstract styling
 \newenvironment{abstract}
{
  \chapter*{Abstract}
  \addcontentsline{toc}{chapter}{Abstract}
  \begin{quote}
}
{
  \end{quote}
}

  \endinput
