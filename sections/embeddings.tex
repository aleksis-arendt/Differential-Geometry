\section{Embeddings}
\subsection{Immersion and Submersion}
\begin{definition}
    Let $M^m$ and $N^n$ be smooth manifolds, and $F: M \to N$ is a smooth map. For abitrary point $p \in M$, we define \text{the rank of $F$ at $p$} to be the rank of the differential $dF_p$. If $\rank (dF_p) = r$ for all $p \in M$, we say $F$ \textit{has the constant rank $r$}.
\end{definition}
\begin{lemma}
    Let $F: M^m \to N^n$ be a smooth map. For abitrary $p \in M$, $dF_p$ is injective if and only if $\rank(dF_p) = n$ and is surjective if and only if $\rank(dF_p) = m$. Consequently, $dF_p$ is bijective if and only if $\rank(dF_p)= m = n$.
\end{lemma}
\begin{definition}
    Let $F: M^m \to N^n$ be the smooth map. Then $F$ is called a \text{smooth immersion} if its differential is injective at each point, and is called a \text{smooth submersion} if its is surjective at each point. 
\end{definition}
\begin{proposition}
    Injectivity and surjectivity of the differential implies local immersion and submersion, respectively.
\end{proposition}
\begin{theorem}[Inverse Function Theorem on Manifolds]
    Let $F: M^m \to N^n$ be a smooth map. If $p \in M$ is point such that $dF_p$ is invertable, then there are connected neighborhoods $U_p$ and $V_{F(p)}$ such that $F|_{U_p}: U_p \to V_{F(p)}$ is a diffeomorphism.
\end{theorem}
\subsection{Constant Rank Theorem}
\begin{theorem}[Constant Rank Theorem]
    Let $M^m$ and $N^n$ be smooth manifolds and $F: M \to N$ be a smooth map with constant rank $r$. For each $p \in M$, there exists smooth charts $(U,\varphi)$ for $M$ containing $p$ and $(V,\psi)$ for $N$ containing $F(p)$ such that $F(U) \subseteq V$, in which $F$ has a coordinate representation of the form 
    \begin{equation}\label{thm:rank}
        \psi \circ F \circ \varphi^{-1}(x^1,\dots, x^r,\dots,x^m) = (x^1,\dots,x^r,0,\dots,0)
    \end{equation}
\end{theorem}
\begin{proof}
    Since the theorem is local, one can view $M$ and $N$ as open subsets $U$ and $V$ in $\bb{R}^m$ and $\bb{R}^n$, respectively.
    For the sake of condition, we can reorder coordinate such that the $r \times r$ block of $DF_p$ has nonzero determinant. Consider the indentification 
    \begin{align*}
     (x,y) &\lra (x^1,\dots,x^r,y^1,\dots,y^{m-r}),\\
    (u,v) &\lra  (u^1,\dots,u^r,v^1,\dots,v^{n-r}).
    \end{align*}
    Then one can view $F(x,y) = (F_1(x,y),F_2,(x,y))$ for some smooth map $F_1: U \to \bb{R}^r$ and $F_2: U \to \bb{R}^{n - r}$. Let $p=(x_p,y_p)$ and $\varphi: U \to \bb{R}^m$ satisfying $\varphi(x,y) = (F_1(x,y),y)$, we have 
    \[
        D\varphi(x_p,y_p)= \begin{bmatrix}
            DF_1(x,y) & \dfrac{\pa F_1}{\pa y}(x,y)\\
            0 & \delta^i_j
        \end{bmatrix}
    \]
    The above assumption implies that $DF_1(x,y)$ and $\delta_i^j$ are invertable, then $D\varphi(x_p,y_p)$ is invertable.  Apply the inverse function theorem for the map $\varphi$ and $p \in U$, there exists connected neighborhoods $U_p$ such that $\varphi|_{U_p}: U_p \to \varphi(U_p)$ is a diffeomorphism. Then we can consider the local chart $(U_p,\varphi)$ which is a restricted diffeomorphism. On the following restriction, we can let $A,B: \varphi(U_p)\to U_p$ be the smooth function satisfying $\varphi^{-1}(x,y) = (A(x,y),B(x,y))$, then we obtain 
    \[
        (x,y) = \varphi(A(x,y),B(x,y)) = (F_1(A(x,y),B(x,y)),B(x,y)).
    \]  
    It follows that $B(x,y) = y$ and $F_1(A(x,y),y) = x$. Hence $F\circ \varphi^{-1}$ is calculated by 
    \[
        F \circ \varphi^{-1}(x,y) = F(A(x,y),y) = (F_1(A(x,y),y),F_2(A(x,y),y)) = (x, C(x,y)),
    \]
    where $C: \varphi(U_p) \to \bb{R}^{n - r}$ defined by $C(x,y) = F_2(A(x,y),y)$. Moreover, since the Jacobian of $F \circ \varphi^{-1}$ at abitrary point $(x,y) \in \varphi(U_p)$ is 
    \[
        D(F\circ \varphi^{-1})(x,y) = \begin{bmatrix}
            \delta^i_j & 0\\
            \dfrac{\pa C^i}{\pa x^j}(x,y) & \dfrac{\pa C^i}{\pa y^j}(x,y)
        \end{bmatrix},
    \]
    where its rank remains at $r$ and the block $\delta^i_j$ has the rank $r$. Then the block $\dfrac{\pa C^i}{\pa y^j}(x,y)$ must vanish to zero. Therefore $C(x,y)$ is independent of $y$ hence we can set $S(x) = C(x,y) = C(x,y_p)$ for all $y$ and then we obtain 
    \begin{equation}\label{thm:3}
        F \circ \varphi^{-1}(x,y) = (x,S(x))
    \end{equation}
        
    
    Let $V_p \subseteq V$ be an open subset satisfying $V_p = \{(u,v) \in V \mid (u,\varphi^2(p)) \in \varphi(U_p)\}$. Then $V_p$ is a neighborhood of $\varphi(p)$ and the definition of $F \circ \varphi^{-1}$ in ~\ref{thm:3} implies that $F \circ \varphi^{-1}(\varphi(U_p)) = F(U_p) \subseteq V_p$. Then we can consider the local chart $(V_p, \psi)$ such that $\psi: V_p \to \bb{R}^n$ satisfying $\psi(u,v) = (u,v - S(u))$. Notice that $(V_p,\psi)$ is a smooth chart, following from ~\ref{thm:3}, we thus have 
    \[
        \psi \circ F \circ \varphi^{-1}(x,y) = \psi(x,S(x)) = (x, S(x)- S(x)) = (x,0).
    \]
    Since $(\varphi,U_p)$ and $(\psi,V_p)$ satisfy the following conditions, the proof is done.
\end{proof}
\begin{corollary} 
    Let $F: M^m \to N^n$ be a smooth map between smooth manifolds and suppose $M$ is connected. Then the followings are equivalent:
    \begin{enumerate}
        \item For each $p \in M$, there exists smooth charts containing $p$ and $F(p)$ in which the coordinate representation of $F$ is linear.
        \item $F$ has constant rank.
    \end{enumerate}
\end{corollary}
\begin{proof}
    First we suppose $F$ has linear coordinate representation in a neighborhoods of each point. Since every linear map has constant rank, it follows that $F$ has constant rank on the following neighborhoods and the fact that $M$ is connected implies that the rank of $F$ is constant on every point of $M$. 
    
    Conversely, if $F$ has constant rank, it follows from the previous theorem that there exists following smooth charts such that $F$ has the representation of the form ~\ref{thm:rank}, which is linear.
\end{proof}
\begin{theorem}
    Let $F: M^m \to N^n$ be a smooth map of constant rank between smooth manifolds.
    \begin{enumerate}
        \item If $F$ is surjective, then it is a smooth submersion.
        \item If $F$ is injective, then it is a smooth immersion.
        \item If $F$ is bijective, then it is a diffeomorphism.
    \end{enumerate}
\end{theorem}
\begin{proof}
    (1) Suppose $F$ is surjective and has constant rank $r < n$. Let $p \in M$, by the Constant Rank Theorem, there exists smooth local charts $(U_p,\varphi_p)$ and $(V_{F(p)},\psi_{F(p)})$ corresponding to $p$ and $F(p)$  such that $F(U_p) \subseteq V_{F(p)}$ in which $F$ has a coordinate representation of the form
    \begin{equation}
        \tilde{F_p}(x^1,\dots,x^m) = (x^1,\dots,x^r,0,\dots).
    \end{equation}
    For the sake of condition, we can shrink $U$ into an $r$-dimensional regular coordinate ball and $F(\clo{U_p}) \subseteq V$. Then $F(\clo{U_p})$ is a compact subset of the set \[\{y \in V \mid y^{r +1} = \dots = y^n = 0\}.\]
    Since such a closed $r$-dimensional cannot contain any $n$-dimensional regular coordinate bals in $N$, $F(\clo{U_p})$ does not include any open subset of $N$. Hence it is nowhere dense in $N$. 

    Since charts $\{(U_p,\varphi_p)\}_{p \in M}$ is an open cover of $M$, then we can choose a subcover $\{(U_p,\varphi_p)\}_{p \in A}$ on $M$. Since $F(M)$ is covered by the corresponding subcover $\{F(\clo{U_p})\}_{p \in A}$, which is countable and every element is nowhere dense, by the Baire category theorem, $\clo{F(M)} = \varnothing$, which contradicts the fact that $F$ is surjective, hence it must be a smooth submersion.
     
    (2)  Suppose $F$ is injective and $r < m$, follows from $(7)$, we have 
    \[
    \tilde{F_p}(x^1,\dots,x^m) = \tilde{F_p}(x^1,\dots,x^r,0,\dots)
    \]
    which implies that $U$ is $r$-dimensional, contradiction. Hence $F$ must be a smooth immersion.

    (3) Follows from $(1)$ and $(2)$, $F$ is both smooth submersion and immersion, it thus is local diffeomorphism. The fact that $F$ is bijective implies that it is diffeomorphism from $M$ onto $N$.
\end{proof}
